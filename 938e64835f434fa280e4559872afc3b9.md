---
jupyter:
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
  language_info:
    codemirror_mode:
      name: ipython
      version: 3
    file_extension: .py
    mimetype: text/x-python
    name: python
    nbconvert_exporter: python
    pygments_lexer: ipython3
    version: 3.13.9
  nbformat: 4
  nbformat_minor: 5
---

::: {#f30c8bfe-1046-400f-913f-fc8883316489 .cell .markdown}
**IMPORTING LIBRARIES**
:::

::: {#10a7ae7f-fbe4-4404-af3a-2c3998ab5c75 .cell .code execution_count="77"}
``` python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns 

from sklearn.model_selection import train_test_split #For training the dataset
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LinearRegression, Ridge, Lasso
from sklearn.ensemble import RandomForestRegressor
from xgboost import XGBRegressor

from sklearn.metrics import mean_squared_error, r2_score
```
:::

::: {#a9d8307a-19ca-456d-9a11-5df5d39c6ad5 .cell .code execution_count="78"}
``` python
!pip install xgboost
```

::: {.output .stream .stdout}
    Requirement already satisfied: xgboost in c:\users\admin\anaconda3\lib\site-packages (3.2.0)
    Requirement already satisfied: numpy in c:\users\admin\anaconda3\lib\site-packages (from xgboost) (2.3.5)
    Requirement already satisfied: scipy in c:\users\admin\anaconda3\lib\site-packages (from xgboost) (1.16.3)
:::
:::

::: {#c3ab334a-3348-4614-8e97-99820b9852f3 .cell .markdown}
**READING THE DATASET**
:::

::: {#908e83a0-dad0-43c3-b282-b4c1ad2938bc .cell .code execution_count="80" scrolled="true"}
``` python
data = pd.read_csv('data.csv')
data.head()
```

::: {.output .execute_result execution_count="80"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>price</th>
      <th>bedrooms</th>
      <th>bathrooms</th>
      <th>sqft_living</th>
      <th>sqft_lot</th>
      <th>floors</th>
      <th>waterfront</th>
      <th>view</th>
      <th>condition</th>
      <th>sqft_above</th>
      <th>sqft_basement</th>
      <th>yr_built</th>
      <th>yr_renovated</th>
      <th>street</th>
      <th>city</th>
      <th>statezip</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014-05-02 00:00:00</td>
      <td>313000.0</td>
      <td>3.0</td>
      <td>1.50</td>
      <td>1340</td>
      <td>7912</td>
      <td>1.5</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1340</td>
      <td>0</td>
      <td>1955</td>
      <td>2005</td>
      <td>18810 Densmore Ave N</td>
      <td>Shoreline</td>
      <td>WA 98133</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-05-02 00:00:00</td>
      <td>2384000.0</td>
      <td>5.0</td>
      <td>2.50</td>
      <td>3650</td>
      <td>9050</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>5</td>
      <td>3370</td>
      <td>280</td>
      <td>1921</td>
      <td>0</td>
      <td>709 W Blaine St</td>
      <td>Seattle</td>
      <td>WA 98119</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014-05-02 00:00:00</td>
      <td>342000.0</td>
      <td>3.0</td>
      <td>2.00</td>
      <td>1930</td>
      <td>11947</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>1930</td>
      <td>0</td>
      <td>1966</td>
      <td>0</td>
      <td>26206-26214 143rd Ave SE</td>
      <td>Kent</td>
      <td>WA 98042</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2014-05-02 00:00:00</td>
      <td>420000.0</td>
      <td>3.0</td>
      <td>2.25</td>
      <td>2000</td>
      <td>8030</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>1000</td>
      <td>1000</td>
      <td>1963</td>
      <td>0</td>
      <td>857 170th Pl NE</td>
      <td>Bellevue</td>
      <td>WA 98008</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2014-05-02 00:00:00</td>
      <td>550000.0</td>
      <td>4.0</td>
      <td>2.50</td>
      <td>1940</td>
      <td>10500</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>1140</td>
      <td>800</td>
      <td>1976</td>
      <td>1992</td>
      <td>9105 170th Ave NE</td>
      <td>Redmond</td>
      <td>WA 98052</td>
      <td>USA</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {#6ee01d40-75d1-4ee7-ae63-ee82422fa621 .cell .code execution_count="81"}
``` python
data.info()
```

::: {.output .stream .stdout}
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 4600 entries, 0 to 4599
    Data columns (total 18 columns):
     #   Column         Non-Null Count  Dtype  
    ---  ------         --------------  -----  
     0   date           4600 non-null   object 
     1   price          4600 non-null   float64
     2   bedrooms       4600 non-null   float64
     3   bathrooms      4600 non-null   float64
     4   sqft_living    4600 non-null   int64  
     5   sqft_lot       4600 non-null   int64  
     6   floors         4600 non-null   float64
     7   waterfront     4600 non-null   int64  
     8   view           4600 non-null   int64  
     9   condition      4600 non-null   int64  
     10  sqft_above     4600 non-null   int64  
     11  sqft_basement  4600 non-null   int64  
     12  yr_built       4600 non-null   int64  
     13  yr_renovated   4600 non-null   int64  
     14  street         4600 non-null   object 
     15  city           4600 non-null   object 
     16  statezip       4600 non-null   object 
     17  country        4600 non-null   object 
    dtypes: float64(4), int64(9), object(5)
    memory usage: 647.0+ KB
:::
:::

::: {#1cf26599-fd3c-4c2f-bc19-463c89b4f2b5 .cell .code execution_count="82"}
``` python
data.describe()
```

::: {.output .execute_result execution_count="82"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>bedrooms</th>
      <th>bathrooms</th>
      <th>sqft_living</th>
      <th>sqft_lot</th>
      <th>floors</th>
      <th>waterfront</th>
      <th>view</th>
      <th>condition</th>
      <th>sqft_above</th>
      <th>sqft_basement</th>
      <th>yr_built</th>
      <th>yr_renovated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4.600000e+03</td>
      <td>4600.000000</td>
      <td>4600.000000</td>
      <td>4600.000000</td>
      <td>4.600000e+03</td>
      <td>4600.000000</td>
      <td>4600.000000</td>
      <td>4600.000000</td>
      <td>4600.000000</td>
      <td>4600.000000</td>
      <td>4600.000000</td>
      <td>4600.000000</td>
      <td>4600.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>5.519630e+05</td>
      <td>3.400870</td>
      <td>2.160815</td>
      <td>2139.346957</td>
      <td>1.485252e+04</td>
      <td>1.512065</td>
      <td>0.007174</td>
      <td>0.240652</td>
      <td>3.451739</td>
      <td>1827.265435</td>
      <td>312.081522</td>
      <td>1970.786304</td>
      <td>808.608261</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.638347e+05</td>
      <td>0.908848</td>
      <td>0.783781</td>
      <td>963.206916</td>
      <td>3.588444e+04</td>
      <td>0.538288</td>
      <td>0.084404</td>
      <td>0.778405</td>
      <td>0.677230</td>
      <td>862.168977</td>
      <td>464.137228</td>
      <td>29.731848</td>
      <td>979.414536</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>370.000000</td>
      <td>6.380000e+02</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>370.000000</td>
      <td>0.000000</td>
      <td>1900.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3.228750e+05</td>
      <td>3.000000</td>
      <td>1.750000</td>
      <td>1460.000000</td>
      <td>5.000750e+03</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>1190.000000</td>
      <td>0.000000</td>
      <td>1951.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>4.609435e+05</td>
      <td>3.000000</td>
      <td>2.250000</td>
      <td>1980.000000</td>
      <td>7.683000e+03</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>1590.000000</td>
      <td>0.000000</td>
      <td>1976.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.549625e+05</td>
      <td>4.000000</td>
      <td>2.500000</td>
      <td>2620.000000</td>
      <td>1.100125e+04</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.000000</td>
      <td>2300.000000</td>
      <td>610.000000</td>
      <td>1997.000000</td>
      <td>1999.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.659000e+07</td>
      <td>9.000000</td>
      <td>8.000000</td>
      <td>13540.000000</td>
      <td>1.074218e+06</td>
      <td>3.500000</td>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>5.000000</td>
      <td>9410.000000</td>
      <td>4820.000000</td>
      <td>2014.000000</td>
      <td>2014.000000</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {#b7690f3f-b98a-4f46-a554-bb3d5fa705c1 .cell .code execution_count="83"}
``` python
data.isnull().sum()
```

::: {.output .execute_result execution_count="83"}
    date             0
    price            0
    bedrooms         0
    bathrooms        0
    sqft_living      0
    sqft_lot         0
    floors           0
    waterfront       0
    view             0
    condition        0
    sqft_above       0
    sqft_basement    0
    yr_built         0
    yr_renovated     0
    street           0
    city             0
    statezip         0
    country          0
    dtype: int64
:::
:::

::: {#65be3f5c-3a56-4861-8430-0a1a47e5d9bf .cell .code execution_count="84"}
``` python
data.dropna()
```

::: {.output .execute_result execution_count="84"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>price</th>
      <th>bedrooms</th>
      <th>bathrooms</th>
      <th>sqft_living</th>
      <th>sqft_lot</th>
      <th>floors</th>
      <th>waterfront</th>
      <th>view</th>
      <th>condition</th>
      <th>sqft_above</th>
      <th>sqft_basement</th>
      <th>yr_built</th>
      <th>yr_renovated</th>
      <th>street</th>
      <th>city</th>
      <th>statezip</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014-05-02 00:00:00</td>
      <td>3.130000e+05</td>
      <td>3.0</td>
      <td>1.50</td>
      <td>1340</td>
      <td>7912</td>
      <td>1.5</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1340</td>
      <td>0</td>
      <td>1955</td>
      <td>2005</td>
      <td>18810 Densmore Ave N</td>
      <td>Shoreline</td>
      <td>WA 98133</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-05-02 00:00:00</td>
      <td>2.384000e+06</td>
      <td>5.0</td>
      <td>2.50</td>
      <td>3650</td>
      <td>9050</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>5</td>
      <td>3370</td>
      <td>280</td>
      <td>1921</td>
      <td>0</td>
      <td>709 W Blaine St</td>
      <td>Seattle</td>
      <td>WA 98119</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014-05-02 00:00:00</td>
      <td>3.420000e+05</td>
      <td>3.0</td>
      <td>2.00</td>
      <td>1930</td>
      <td>11947</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>1930</td>
      <td>0</td>
      <td>1966</td>
      <td>0</td>
      <td>26206-26214 143rd Ave SE</td>
      <td>Kent</td>
      <td>WA 98042</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2014-05-02 00:00:00</td>
      <td>4.200000e+05</td>
      <td>3.0</td>
      <td>2.25</td>
      <td>2000</td>
      <td>8030</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>1000</td>
      <td>1000</td>
      <td>1963</td>
      <td>0</td>
      <td>857 170th Pl NE</td>
      <td>Bellevue</td>
      <td>WA 98008</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2014-05-02 00:00:00</td>
      <td>5.500000e+05</td>
      <td>4.0</td>
      <td>2.50</td>
      <td>1940</td>
      <td>10500</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>1140</td>
      <td>800</td>
      <td>1976</td>
      <td>1992</td>
      <td>9105 170th Ave NE</td>
      <td>Redmond</td>
      <td>WA 98052</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4595</th>
      <td>2014-07-09 00:00:00</td>
      <td>3.081667e+05</td>
      <td>3.0</td>
      <td>1.75</td>
      <td>1510</td>
      <td>6360</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>1510</td>
      <td>0</td>
      <td>1954</td>
      <td>1979</td>
      <td>501 N 143rd St</td>
      <td>Seattle</td>
      <td>WA 98133</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>4596</th>
      <td>2014-07-09 00:00:00</td>
      <td>5.343333e+05</td>
      <td>3.0</td>
      <td>2.50</td>
      <td>1460</td>
      <td>7573</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1460</td>
      <td>0</td>
      <td>1983</td>
      <td>2009</td>
      <td>14855 SE 10th Pl</td>
      <td>Bellevue</td>
      <td>WA 98007</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>4597</th>
      <td>2014-07-09 00:00:00</td>
      <td>4.169042e+05</td>
      <td>3.0</td>
      <td>2.50</td>
      <td>3010</td>
      <td>7014</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3010</td>
      <td>0</td>
      <td>2009</td>
      <td>0</td>
      <td>759 Ilwaco Pl NE</td>
      <td>Renton</td>
      <td>WA 98059</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>4598</th>
      <td>2014-07-10 00:00:00</td>
      <td>2.034000e+05</td>
      <td>4.0</td>
      <td>2.00</td>
      <td>2090</td>
      <td>6630</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1070</td>
      <td>1020</td>
      <td>1974</td>
      <td>0</td>
      <td>5148 S Creston St</td>
      <td>Seattle</td>
      <td>WA 98178</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>4599</th>
      <td>2014-07-10 00:00:00</td>
      <td>2.206000e+05</td>
      <td>3.0</td>
      <td>2.50</td>
      <td>1490</td>
      <td>8102</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>1490</td>
      <td>0</td>
      <td>1990</td>
      <td>0</td>
      <td>18717 SE 258th St</td>
      <td>Covington</td>
      <td>WA 98042</td>
      <td>USA</td>
    </tr>
  </tbody>
</table>
<p>4600 rows Ã— 18 columns</p>
</div>
```
:::
:::

::: {#01e5fbe1-b98d-4bb9-b8dc-3464cd9322eb .cell .markdown}
**EXPLORATORY DATA ANALYSIS (EDA)**
:::

::: {#8d83818e-671b-4cd1-9dae-dce8fd30cf4e .cell .markdown}
*Now we are converting or droping them (date, address and city) so the
heatmap can be generated without errors.This is because correlation
heatmaps require numeric datas only, not text*
:::

::: {#3df960fa-0f5b-428e-986c-9d7aff020309 .cell .code execution_count="85"}
``` python
# Convert date column to datetime
data['date'] = pd.to_datetime(data['date'])

# Extract numeric features
data['year'] = data['date'].dt.year
data['month'] = data['date'].dt.month
data['day'] = data['date'].dt.day

# Drop original date column
data = data.drop('date', axis=1)
```
:::

::: {#7f4fe295-e636-4596-9a30-4bc752275404 .cell .code execution_count="86"}
``` python
# Drop non-numeric text columns that cannot be used
text_cols = ['address', 'street', 'addr', 'neighbourhood']
data = data.drop(columns=[col for col in text_cols if col in data.columns])
```
:::

::: {#254f63ee-c7fe-422a-8471-b44b613ecdeb .cell .code execution_count="87"}
``` python
# 1. Convert date columns (if any)
for col in data.columns:
    if "date" in col.lower():
        data[col] = pd.to_datetime(data[col], errors='ignore')

# 2. Convert datetime columns to year/month/day
for col in data.columns:
    if data[col].dtype == 'datetime64[ns]':
        data[col + '_year'] = data[col].dt.year
        data[col + '_month'] = data[col].dt.month
        data[col + '_day'] = data[col].dt.day
        data = data.drop(col, axis=1)

# 3. One-hot encode all remaining object (text) columns
cat_cols = data.select_dtypes(include=['object']).columns
data = pd.get_dummies(data, columns=cat_cols, drop_first=True)
```
:::

::: {#fb6bb4c8-a127-4480-adb7-3109afb34c64 .cell .markdown}
***Now plotting the graph***
:::

::: {#9b02790b-19d0-4a3d-a196-2cf011a338bd .cell .code execution_count="88"}
``` python
plt.figure(figsize=(12,8))
sns.heatmap(data.corr(), cmap = 'coolwarm', annot = False)
plt.title("Correlation Heatmap")
plt.show()
```

::: {.output .display_data}
![](vertopal_938e64835f434fa280e4559872afc3b9/6c92776ffadf3278d0c9937437ae048d369e8aca.png)
:::
:::

::: {#c0f790fe-b683-47f3-9f17-8d4c091137c8 .cell .markdown}
**DISTRIBUTION OF TARGET VARIABLE (PRICE)**
:::

::: {#f292c7ad-05ac-476b-b489-13ba2c06bc41 .cell .code execution_count="89"}
``` python
sns.histplot(data["price"], kde = True)
plt.title("price distribution")
plt.show()
```

::: {.output .display_data}
![](vertopal_938e64835f434fa280e4559872afc3b9/668b290be62c1c41d3c3f802897b04b843237e30.png)
:::
:::

::: {#273abdcd-d202-47d7-8f66-f2ab17125cd3 .cell .markdown}
**SELECTING FEATURES & TARGET**

\*Assuming dataset has:

*sqft_living*

*bedrooms*

*bathrooms*

*floors*

*age*

*location (categorical)*

*price (target)*
:::

::: {#82636d95-5dd4-4242-bf39-adc6cff58a1e .cell .code execution_count="90"}
``` python
X = data.drop("price", axis = 1)
y = data["price"]
X = pd.get_dummies(X,drop_first = True)
```
:::

::: {#47381e82-836b-468d-9dcf-28ec7aed524c .cell .markdown}
**TRAIN-TEST SPLIT**
:::

::: {#ae4ba69d-260e-497c-858e-c5155af8a688 .cell .code execution_count="91"}
``` python
X_train,X_test,y_train,y_test = train_test_split(X,y,test_size = 0.2, random_state = 42)
```
:::

::: {#da489fa5-c6ea-4279-934e-08032ee3ed4d .cell .markdown}
**SCALING THE DATA**
:::

::: {#6304d60f-a5e3-4998-9cf2-b0a525d79aab .cell .code execution_count="92"}
``` python
scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)
```
:::

::: {#32d2ae28-f4c8-4ab9-a84e-c4967b24696a .cell .markdown}
**TRAINING MODELS**
:::

::: {#b0bd1467-9b50-4762-8da9-4f67ffb5070e .cell .markdown}
***MODEL 1 : LINEAR REGESSION***
:::

::: {#1729cd34-b90a-4771-b5cb-d918f3e82f30 .cell .code execution_count="93"}
``` python
linear_model = LinearRegression()
linear_model.fit(X_train, y_train)

pred_linear_model = linear_model.predict(X_test)

print("Linear Regression RMSE:", 
      np.sqrt(mean_squared_error(y_test, pred_linear_model)))
print("R2 Score", r2_score(y_test, pred_linear_model))
```

::: {.output .stream .stdout}
    Linear Regression RMSE: 981455.3815551021
    R2 Score 0.05549039289453994
:::
:::

::: {#4a1bdef6-1d69-409a-a062-e5591f8db12a .cell .markdown}
***MODEL 2 : LASSO REGRESSION***
:::

::: {#82ff7686-6992-48cf-a52d-9dd5da069df7 .cell .code execution_count="94"}
``` python
lasso_model = Lasso(alpha = 0.1)
lasso_model.fit(X_train, y_train)

pred_lasso_model = lasso_model.predict(X_test)

print("Lasso RMSE:", 
      np.sqrt(mean_squared_error(y_test, pred_lasso_model)))
print("R2 Score", r2_score(y_test, pred_lasso_model))
```

::: {.output .stream .stdout}
    Lasso RMSE: 981452.3647719651
    R2 Score 0.05549619932513228
:::

::: {.output .stream .stderr}
    C:\Users\Admin\anaconda3\Lib\site-packages\sklearn\linear_model\_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 6.869e+13, tolerance: 5.229e+10
      model = cd_fast.enet_coordinate_descent(
:::
:::

::: {#0b2c6460-cbd5-4cb8-af47-73c31a09865f .cell .markdown}
***MODEL 3: RANDOM FOREST REGRESSOR***
:::

::: {#6daf2f21-c9fc-491e-87e8-eb6415474331 .cell .code execution_count="95"}
``` python
rf_model = RandomForestRegressor(n_estimators = 200, random_state = 42)
rf_model.fit(X_train, y_train)

pred_rf_model = rf_model.predict(X_test)

print("Random Forest RMSE:", 
      np.sqrt(mean_squared_error(y_test, pred_rf_model)))
print("R2 Score", r2_score(y_test, pred_rf_model))
```

::: {.output .stream .stdout}
    Random Forest RMSE: 985057.7231183498
    R2 Score 0.04854419755786543
:::
:::

::: {#2c8eed3d-affd-4e26-92bd-1bb92cd2691e .cell .markdown}
***MODEL 4: XGBOOST REGRESSOR***
:::

::: {#304d4ea5-28ab-480b-b03e-7935a2401d00 .cell .code execution_count="96"}
``` python
xgb_model = XGBRegressor(n_estimators = 300, learning_rate = 0.05, random_state = 42)
xgb_model.fit(X_train, y_train)

pred_xgb_model = xgb_model.predict(X_test)

print("XGBoost RMSE:", 
      np.sqrt(mean_squared_error(y_test, pred_xgb_model)))
print("R2 Score", r2_score(y_test, pred_xgb_model))
```

::: {.output .stream .stdout}
    XGBoost RMSE: 978268.514124846
    R2 Score 0.06161423725221493
:::
:::

::: {#2736c47c-6f80-4225-b55b-f79285c89080 .cell .markdown}
**COMBINING ALL THE MODELS**
:::

::: {#4ba6d167-4f5f-4538-b1b8-110ddd885774 .cell .code execution_count="97"}
``` python
models = ["Linear Regression", "Lasso", "Random Forest", "XGBoost"]
rmse_scores = [
    np.sqrt(mean_squared_error(y_test, pred_linear_model)),
    np.sqrt(mean_squared_error(y_test, pred_lasso_model)),
    np.sqrt(mean_squared_error(y_test, pred_rf_model)),
    np.sqrt(mean_squared_error(y_test, pred_xgb_model))
]
plt.figure(figsize = (10,6))
plt.bar(x = models, height = rmse_scores)
plt.title("RMSE_Values/Models Comparison")
plt.xlabel("Models")
plt.ylabel("RMSE values")
plt.show()
```

::: {.output .display_data}
![](vertopal_938e64835f434fa280e4559872afc3b9/d20fd0b505067dc428d201e958b333460f2429ca.png)
:::
:::

::: {#fcc9dff7-1083-4aa9-8eeb-721e520c138f .cell .markdown}
*Here the graph is almost same for every models and as a result we
cannot choose our best model for the project. So we will use r2 scores
instead of RMSE Scores for better selection of model*
:::

::: {#2064632a-24fd-4e24-8353-891c80e9b5ae .cell .code execution_count="98"}
``` python
models = ["Linear Regression", "Lasso", "Random Forest", "XGBoost"]
r2_scores = [
    r2_score(y_test, pred_linear_model),
    r2_score(y_test, pred_lasso_model),
    r2_score(y_test, pred_rf_model),
    r2_score(y_test, pred_xgb_model)
]
plt.figure(figsize = (10,6))
plt.bar(x = models, height = r2_scores)
plt.title("R2_scores/Models Comparison")
plt.xlabel("Models")
plt.ylabel("R2 Scores")
plt.show()
```

::: {.output .display_data}
![](vertopal_938e64835f434fa280e4559872afc3b9/d4cf2b55b6fb82309eb3a851c356eb0adc256984.png)
:::
:::

::: {#05f07998-d9c2-41d7-b05b-a9573f336a4e .cell .markdown}
***XGBoost*** *model performs best*
:::

::: {#65a21299-3012-46d9-b882-29e00088a58d .cell .markdown}
**CHOOSING THE BEST MODEL(XGBOOST MODEL)**
:::

::: {#54ce8556-6ede-4b09-9688-a86d48e12358 .cell .markdown}
*We have used PICKLE Library as it is used to save and load ML Models*
:::

::: {#6a399ce6-b101-4ab8-982c-239f9f9e409f .cell .code execution_count="99"}
``` python
import pickle
model = pickle.dump(xgb_model, open("House_price_prediction.pkl", "wb"))
scaler = pickle.dump(scaler, open("scaler.pkl", "wb"))
```
:::

::: {#d15d89aa-3c78-4dac-92f5-5cfe90d5e373 .cell .markdown}
**PREDICTION ON NEW DATA**
:::

::: {#b4760474-c100-487b-98de-476820401aed .cell .code execution_count="100"}
``` python
My_new_house_data = {
    "sqft_living" : 16000,
    "sqft_lot" : 13000,
    "bedrooms" : 2,
    "bathrooms" : 1,
    "floors" : 2,
    "waterfront" : 0,
    "view" : 4,
    "sqft_above" : 12000,
    "sqft_basement" : 4000
}

new_df = pd.DataFrame([My_new_house_data])
new_df_dummies = pd.get_dummies(new_df, drop_first = True)
new_df_dummies = new_df_dummies.reindex(columns = X.columns, fill_value = 0)

scaler = StandardScaler()
scaler.fit(X)

new_df_scaled = scaler.transform(new_df_dummies)

predicted_price = xgb_model.predict(new_df_scaled)[0]

print("Predicted House Price:", predicted_price)
```

::: {.output .stream .stdout}
    Predicted House Price: 2.3471848e+06
:::
:::

::: {#4b0d730a-799b-47af-97b8-fa2a7abf5ea5 .cell .code execution_count="101"}
``` python
X.columns
```

::: {.output .execute_result execution_count="101"}
    Index(['bedrooms', 'bathrooms', 'sqft_living', 'sqft_lot', 'floors',
           'waterfront', 'view', 'condition', 'sqft_above', 'sqft_basement',
           ...
           'statezip_WA 98155', 'statezip_WA 98166', 'statezip_WA 98168',
           'statezip_WA 98177', 'statezip_WA 98178', 'statezip_WA 98188',
           'statezip_WA 98198', 'statezip_WA 98199', 'statezip_WA 98288',
           'statezip_WA 98354'],
          dtype='object', length=134)
:::
:::

::: {#59857d55-f92d-41a6-97ac-ac9877ef9d06 .cell .markdown}
**MODEL ACCURACY PREDICTION**
:::

::: {#d05e9826-cd1e-4a9d-8818-c789090d20ed .cell .code execution_count="103"}
``` python
from sklearn.metrics import accuracy_score

pred_xgb_model_classes = (pred_xgb_model > 0.5).astype(int)
y_test_binary = (y_test > 0.5).astype(int)
accuracy = accuracy_score(y_test_binary, pred_xgb_model_classes)  
print(f"Accuracy : {accuracy:.4f}")
```

::: {.output .stream .stdout}
    Accuracy : 0.9902
:::
:::

::: {#d2dce562-25f0-4639-ba94-bfb6a743c234 .cell .code}
``` python
```
:::
